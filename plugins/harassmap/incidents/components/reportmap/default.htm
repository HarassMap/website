<div class="report-map">
    <div class="container">
        <div class="controls">
            <a class="control control--map active" href="#report-map">
                <span class="icon"></span>
                {{ 'Map' | _ }}
            </a>
            {#<a class="control control--chart" href="#chart">#}
            {#<span class="icon"></span>#}
            {#{{ 'Chart' | _ }}#}
            {#</a>#}
            <a class="control control--table" href="#table">
                <span class="icon"></span>
                {{ 'Table' | _ }}
            </a>
        </div>
    </div>

    <div id="report-map" class="banner banner--map active">
        <div id="map" class="map map--home" data-map="homepage" data-lat="{{ domain.lat }}"
             data-lng="{{ domain.lng }}"
             data-zoom="{{ domain.zoom }}" data-link="{{ 'reports/view' | page({id: 'REPORT_ID'}) }}"></div>

        <div class="toolbar">
            <div class="container container--filter">
                <div class="filter">
                    <form id="filter-form">
                        <div class="row">
                            <div class="col-6">
                                This is the date
                            </div>
                            <div class="col-3">
                                <select class="form-control form-control-range" name="type">
                                    <option>{{ 'Type' | _ }}</option>
                                    <option value="incident">{{ 'Incident' | _ }}</option>
                                    <option value="intervention">{{ 'Intervention' | _ }}</option>
                                </select>
                            </div>
                            <div class="col-3 text-center">
                                <button class="btn btn--inverse">{{ 'Go' | _ }}</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="legend--container">
                <div class="container">
                    <div class="row">
                        <div class="col-12">
                            <div class="legend">
                                <span class="key key--incident">
                                    <span class="icon"></span>
                                    {{ 'Incident' | _ }}
                                </span>
                                <span class="key key--intervention">
                                <span class="icon"></span>
                                    {{ 'Incidents with intervention' | _ }}
                                </span>
                            </div>

                            <a href="#" id="map-fullscreen" class="btn float-right btn--fullscreen ml-2">
                                &nbsp; <span class="sr-only">{{ 'Full Screen' | _ }}</span>
                            </a>

                            <a href="#" id="map-filter" class="btn btn--inverse float-right">{{ 'Filter' | _ }}</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="chart" class="banner banner--chart sep--top"></div>

    <div id="table" class="banner banner--table sep--top">
        <div class="container">
            <h3>{{ 'Reports' | _ }}</h3>

            <table class="table table-hover">
                <thead>
                <tr>
                    <th class="date">{{ 'Date' | _ }}</th>
                    <th>{{ 'Type' | _ }}</th>
                    <th>{{ 'Description' | _ }}</th>
                    <th>{{ 'Location' | _ }}</th>
                    <th>{{ 'Categories' | _ }}</th>
                </tr>
                </thead>
                <tbody>
                {% for report in reports %}
                    <tr class="row-link" data-href="{{ viewPage | page({id: report.public_id}) }}">
                        <td>{{ report.date | date("d / m / Y", domain.timezone) }}</td>
                        <td class="type">
                            <span class="icon icon--{{ report.intervention ? 'intervention' : 'incident' }}"></span>
                            <span class="sr-only">{{ report.intervention ? 'Intervention' : 'Incident' }}</span>
                        </td>
                        <td>{{ report.description | slice(0, 50) }}</td>
                        <td>{{ report.location.address }}, {{ report.location.city }}</td>
                        <td>{% for category in report.categories | slice(0, 2) %}{% if loop.index > 1 %}, {% endif %}{{ category.title }}{% endfor %}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="toolbar">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <div class="legend">
                            <span class="key key--incident">
                                <span class="icon"></span>
                                {{ 'Incident' | _ }}
                            </span>
                            <span class="key key--intervention">
                                <span class="icon"></span>
                                {{ 'Incidents with intervention' | _ }}
                            </span>
                        </div>

                        <a href="{{ tablePage | page }}" class="btn btn--inverse float-right">{{ 'Read More' | _ }}</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% put scripts %}
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDmmPliZYFcKVjG_aJ6AMSYyHCWkmSlNpc&callback=initMap"></script>
<script>
    initBanner();
</script>
<script id="info-template" type="text/x-handlebars-template">
    <div class="infowindow">
        {% raw %}

        <div class="info info--time">
            <span class="icon icon--time"></span>
            {{ time }}
        </div>
        <div class="info info--address">
            <span class="icon icon--address"></span>
            {{ address }}
        </div>

        <a class="read-more" href="{{ link }}">
            {% endraw %}
            {{ 'Read more' | _ }}
        </a>
    </div>
</script>
{% endput %}