<div class="container">
    <div class="row mb-4">
        <div class="col-12">
            <h3 class="hr">
                <span class="hr__line"></span>
                <span class="hr__text">
                    {{ 'Report' | _ }}
            </span>
            </h3>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <h3>
                {% if report.intervention %}
                    {{ 'Intervention happened on :date at :time' |
                    _({ date : report.date | date('d/m/Y', domain.timezone), time : report.date | date('g:iA', domain.timezone) }) }}
                {% else %}
                    {{ 'Incident happened on :date at :time' |
                    _({ date : report.date | date('d/m/Y', domain.timezone), time : report.date | date('g:iA', domain.timezone) }) }}
                {% endif %}
            </h3>
            <p class="pt-2 pb-0">
                {{ 'at :location' | _({location: report.location.address}) }}
                ({{ report.location.lat }} {{ report.location.lng }})
            </p>
        </div>
    </div>

    <div class="row">
        <div class="col-12 col-sm-9">
            {% if report.approved %}
                <p class="read-more">
                    {{ report.description | nl2br }}
                </p>
            {% else %}
                <p class="faded">
                    {{ 'We check all report descriptions to ensure anonymity and confidentiality. You will be able to view the full text soon.' | _ }}
                </p>
            {% endif %}
        </div>
        <div class="col-12 col-sm-3">

            {% if report.verified %}
                <p class="pt-1 pb-1">{{ 'Verified' | _ }}</p>
            {% endif %}

            <p class="pt-1 pb-1">
                {% if report.support == 1 %}
                    {{ ':support expression of support.'|_({ support: report.support }) }}
                {% elseif report.support > 1 %}
                    {{ ':support expressions of support.'|_({ support: report.support }) }}
                {% else %}
                    {{ 'No expressions of support.' | _ }}
                {% endif %}
            </p>

            <a href="#comment" class="btn btn--default mb-2 mt-2">{{ 'Add Comment' | _ }}</a>

            <form data-request="onExpressSupport">
                <button class="btn btn--default">{{ 'Express Support' | _ }}</button>
            </form>
        </div>
    </div>

    <div class="row mt-3 mb-4">
        <div class="col-12 categories">
            <span class="category mb-1 category--title">
                {{ 'Categories' | _ }}
            </span>
            {% for category in report.categories %}
                <span class="category mb-1">
                    {{ category.title }}
                </span>
            {% endfor %}
        </div>
    </div>

    {% if report.intervention %}
        <div class="row mt-3 mb-4">
            <div class="col-12 categories">
            <span class="category mb-1 category--title">
                {{ 'Assistance' | _ }}
            </span>
                {% for assistance in report.intervention.assistance %}
                    <span class="category mb-1">
                    {{ assistance.title }}
                </span>
                {% endfor %}
            </div>
        </div>
    {% endif %}
</div>

<div id="map" class="map map--report" data-map="reports" data-type="{{ report.intervention ? 'intervention' : 'incident' }}"
     data-lat="{{ report.location.lat }}" data-lng="{{ report.location.lng }}"></div>

{% put scripts %}
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDmmPliZYFcKVjG_aJ6AMSYyHCWkmSlNpc&callback=initMap"></script>

<script>
    $('.read-more').readmore({
        moreLink: '<a href="#" class="btn">{{ 'Read More' | _ }}</a>',
        lessLink: '<a href="#" class="btn">{{ 'Close' | _ }}</a>'
    });
</script>
{% endput %}

{% put meta %}
<meta property="og:url" content="{{ 'reports/view' | page }}"/>
<meta property="og:description" content="{{ report.description }}"/>

{% if report.intervention %}
    <meta property="og:title" content="{{ 'Intervention happened on :date at :time' |
    _({ date : report.date | date('d/m/Y', domain.timezone), time : report.date | date('g:iA', domain.timezone) }) }}"/>
{% else %}
    <meta property="og:title" content="{{ 'Incident happened on :date at :time' |
    _({ date : report.date | date('d/m/Y', domain.timezone), time : report.date | date('g:iA', domain.timezone) }) }}"/>
{% endif %}

{% endput %}